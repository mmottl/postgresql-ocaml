<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>connection (postgresql.Postgresql.connection)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">postgresql</a> &#x00BB; <a href="../index.html">Postgresql</a> &#x00BB; connection</nav><header class="odoc-preamble"><h1>Class <code><span>Postgresql.connection</span></code></h1><p>Class of connections.</p><p>When <code>conninfo</code> is given, it will be used instead of all other optional arguments.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">startonly</span> <p>If true, initiate a non-blocking connect procedure, which involves cooperative calls to <a href="#method-connect_poll"><code>connection.connect_poll</code></a> before the connection is usable.</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <a href="../index.html#exception-Error"><code>Error</code></a> <p>if there is a connection failure.</p></li></ul></header><div class="odoc-content"><div class="odoc-spec"><div class="spec method anchored" id="method-finish"><a href="#method-finish" class="anchor"></a><code><span><span class="keyword">method</span> finish : unit</span></code></div><div class="spec-doc"><p><code>#finish</code> closes the connection.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-try_reset"><a href="#method-try_reset" class="anchor"></a><code><span><span class="keyword">method</span> try_reset : unit</span></code></div><div class="spec-doc"><p><code>#try_reset</code> tries to reset the connection if it is bad. If resetting fails, the <code>error</code> exception will be raised with <code>Connection_failure</code>.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-reset"><a href="#method-reset" class="anchor"></a><code><span><span class="keyword">method</span> reset : unit</span></code></div><div class="spec-doc"><p><code>#reset</code> resets the connection.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><p>Asynchronous Notification</p><div class="odoc-spec"><div class="spec method anchored" id="method-notifies"><a href="#method-notifies" class="anchor"></a><code><span><span class="keyword">method</span> notifies : <span><a href="../Notification/index.html#type-t">Notification.t</a> option</span></span></code></div><div class="spec-doc"><p><code>#notifies</code></p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p><code>Some notification</code> if available (<code>None</code> otherwise).</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><p>Control Functions</p><div class="odoc-spec"><div class="spec method anchored" id="method-set_notice_processor"><a href="#method-set_notice_processor" class="anchor"></a><code><span><span class="keyword">method</span> set_notice_processor : <span><span>(<span>string <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>#set_notice_processor</code> controls reporting of notice and warning messages generated by a connection.</p><p><em>Warning:</em> This function is unsafe in combination with a number of libpq entry points, and should not be used for now. As a workaround, <code>connection.set_notice_processing</code> can be used to silence notices, if this is more appropriate than the default behaviour of printing them to standard error.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-set_notice_processing"><a href="#method-set_notice_processing" class="anchor"></a><code><span><span class="keyword">method</span> set_notice_processing : <span><span>[ `Stderr <span>| `Quiet</span> ]</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>#set_notice_processing</code> controls reporting of notice and warning messages generated by a connection by providing predefined callbacks.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><p>Accessors</p><div class="odoc-spec"><div class="spec method anchored" id="method-db"><a href="#method-db" class="anchor"></a><code><span><span class="keyword">method</span> db : string</span></code></div><div class="spec-doc"><p><code>#db</code></p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>database name of the connection.</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-user"><a href="#method-user" class="anchor"></a><code><span><span class="keyword">method</span> user : string</span></code></div><div class="spec-doc"><p><code>#user</code></p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>user name of the connection.</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-pass"><a href="#method-pass" class="anchor"></a><code><span><span class="keyword">method</span> pass : string</span></code></div><div class="spec-doc"><p><code>#pass</code></p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>password of the connection.</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-host"><a href="#method-host" class="anchor"></a><code><span><span class="keyword">method</span> host : string</span></code></div><div class="spec-doc"><p><code>#host</code></p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>server host name of the connection.</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-port"><a href="#method-port" class="anchor"></a><code><span><span class="keyword">method</span> port : string</span></code></div><div class="spec-doc"><p><code>#port</code></p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>port of the connection.</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-tty"><a href="#method-tty" class="anchor"></a><code><span><span class="keyword">method</span> tty : string</span></code></div><div class="spec-doc"><p><code>#tty</code></p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>debug tty of the connection.</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-options"><a href="#method-options" class="anchor"></a><code><span><span class="keyword">method</span> options : string</span></code></div><div class="spec-doc"><p><code>#options</code></p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>backend options of the connection.</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-status"><a href="#method-status" class="anchor"></a><code><span><span class="keyword">method</span> status : <a href="../index.html#type-connection_status">connection_status</a></span></code></div><div class="spec-doc"><p><code>#status</code></p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>current connection status.</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-error_message"><a href="#method-error_message" class="anchor"></a><code><span><span class="keyword">method</span> error_message : string</span></code></div><div class="spec-doc"><p><code>#error_message</code></p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>most recent error message of the connection.</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-backend_pid"><a href="#method-backend_pid" class="anchor"></a><code><span><span class="keyword">method</span> backend_pid : int</span></code></div><div class="spec-doc"><p><code>#backend</code></p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>process id of the backend server of the connection.</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-server_version"><a href="#method-server_version" class="anchor"></a><code><span><span class="keyword">method</span> server_version : int * int * int</span></code></div></div><p>Commands and Queries</p><div class="odoc-spec"><div class="spec method anchored" id="method-empty_result"><a href="#method-empty_result" class="anchor"></a><code><span><span class="keyword">method</span> empty_result : <span><a href="../index.html#type-result_status">result_status</a> <span class="arrow">&#45;&gt;</span></span> <a href="../class-type-result/index.html">result</a></span></code></div><div class="spec-doc"><p><code>empty_result stat</code></p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>dummy result with a given status <code>stat</code>.</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-exec"><a href="#method-exec" class="anchor"></a><code><span><span class="keyword">method</span> exec : <span><span class="optlabel">?expect</span>:<span><a href="../index.html#type-result_status">result_status</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?param_types</span>:<span><a href="../index.html#type-oid">oid</a> array</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?params</span>:<span>string array</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?binary_params</span>:<span>bool array</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?binary_result</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <a href="../class-type-result/index.html">result</a></span></code></div><div class="spec-doc"><p><code>exec ?expect ?params ?param_types ?binary_params ?binary_result query</code> synchronous execution of query or command <code>query</code>. The result status will be checked against all elements in <code>expect</code>. If <code>expect</code> is not empty and if there is no match, the exception <code>Unexpected_status</code> will be raised.</p><p>Additional query parameters can be passed in the <code>params</code> array. They must not be escaped and they can be referred to in <code>query</code> as $1, $2, ... The value <code>null</code> can be used in the <code>params</code> array to denote an SQL NULL. It is possible to specify that some of the query parameters are passed as binary strings using the <code>binary_params</code> array. By default, results are returned in text format, but will be returned in binary format if <code>binary_result</code> is true.</p><p>If no (or an empty) query parameter is passed, it is possible to emit several commands with a single call.</p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>result of query.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">expect</span> <p>default = </p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">param_types</span> <p>default = <code>||</code></p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">params</span> <p>default = <code>||</code></p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">binary_params</span> <p>default = <code>||</code></p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">binary_result</span> <p>default = false</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is an unexpected result status.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-prepare"><a href="#method-prepare" class="anchor"></a><code><span><span class="keyword">method</span> prepare : <span><span class="optlabel">?param_types</span>:<span><a href="../index.html#type-oid">oid</a> array</span> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <a href="../class-type-result/index.html">result</a></span></code></div><div class="spec-doc"><p><code>prepare ?param_types stm_name query</code> creates a prepared query named <code>stm_name</code> which will execute the query or command <code>query</code> when passed to <code>#exec_prepared</code>.</p></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-exec_prepared"><a href="#method-exec_prepared" class="anchor"></a><code><span><span class="keyword">method</span> exec_prepared : <span><span class="optlabel">?expect</span>:<span><a href="../index.html#type-result_status">result_status</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?params</span>:<span>string array</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?binary_params</span>:<span>bool array</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <a href="../class-type-result/index.html">result</a></span></code></div><div class="spec-doc"><p><code>exec_prepared ?expect ?params ?binary_params stm_name</code> acts as <code>#exec</code>, except executes the prepared query <code>stm_name</code>.</p></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-describe_prepared"><a href="#method-describe_prepared" class="anchor"></a><code><span><span class="keyword">method</span> describe_prepared : <span>string <span class="arrow">&#45;&gt;</span></span> <a href="../class-type-result/index.html">result</a></span></code></div><div class="spec-doc"><p><code>#describe_prepared stm_name</code> submits a request to obtain information about the specified prepared statement, and waits for completion. <code>connection.describe_prepared</code> allows an application to obtain information about a previously prepared statement. The <code>stm_name</code> parameter can be the empty string (&quot;&quot;) to reference the unnamed statement, otherwise it must be the name of an existing prepared statement. On success, a <code>result</code> with status <code>Command_ok</code> is returned. The methods <code>result.nparams</code> and <code>result.paramtype</code> of the class <code>result</code> can be used to obtain information about the parameters of the prepared statement, and the methods <code>result.nfields</code>, <code>result.fname</code> and <code>result.ftype</code> provide information about the result columns (if any) of the statement.</p><p>To prepare a statement use the SQL command PREPARE.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">stm_name</span> <p>The name of the previously prepared query</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul><ul class="at-tags"><li class="see"><span class="at-tag">see</span> <a href="http://www.postgresql.org/docs/8.3/interactive/sql-prepare.html" class="value">http://www.postgresql.org/docs/8.3/interactive/sql-prepare.html</a> <p>PostgreSQL documentation about <code>PREPARE</code></p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-send_query"><a href="#method-send_query" class="anchor"></a><code><span><span class="keyword">method</span> send_query : <span><span class="optlabel">?param_types</span>:<span><a href="../index.html#type-oid">oid</a> array</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?params</span>:<span>string array</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?binary_params</span>:<span>bool array</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p><code>send_query ?param_types ?params ?binary_params query</code> asynchronous execution of query or command <code>query</code>.</p><p>Additional query parameters can be passed in the <code>params</code> array. They must not be escaped and they can be referred to in <code>query</code> as $1, $2, ... The value <code>null</code> can be used in the <code>params</code> array to denote an SQL NULL. It is possible to specify that some of the query parameters are passed as binary strings using the <code>binary_params</code> array.</p><p>If no (or an empty) query parameter is passed, it is possible to emit several commands with a single call.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">param_types</span> <p>default = <code>||</code></p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">params</span> <p>default = <code>||</code></p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">binary_params</span> <p>default = <code>||</code></p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-send_prepare"><a href="#method-send_prepare" class="anchor"></a><code><span><span class="keyword">method</span> send_prepare : <span><span class="optlabel">?param_types</span>:<span><a href="../index.html#type-oid">oid</a> array</span> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>#send_prepare ?param_types stm_name query</code> sends a query preparation without waiting for the result. This does the same as <code>connection.prepare</code> except that the status is reported by <code>connection.get_result</code> when available.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-send_query_prepared"><a href="#method-send_query_prepared" class="anchor"></a><code><span><span class="keyword">method</span> send_query_prepared : <span><span class="optlabel">?params</span>:<span>string array</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?binary_params</span>:<span>bool array</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p><code>#send_query_prepared ?params ?binary_params stm_name</code> is an asynchronous version of <code>connection.exec_prepared</code>. The semantics is otherwise the same, and the result is reported by <code>connection.get_result</code> when available.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">params</span> <p>default = <code>||</code></p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">binary_params</span> <p>default = <code>||</code></p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-send_describe_prepared"><a href="#method-send_describe_prepared" class="anchor"></a><code><span><span class="keyword">method</span> send_describe_prepared : <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>#send_describe_prepared stm_name</code> sends a request for a description of a prepared query without waiting for the result. The result must be fetched with <code>connection.get_result</code> when it becomes available. Otherwise it does the same as <code>connection.describe_prepared</code>.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-send_describe_portal"><a href="#method-send_describe_portal" class="anchor"></a><code><span><span class="keyword">method</span> send_describe_portal : <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>#send_describe_portal portal_name</code> sends a request for a description of the named portal. The result must be fetched with <code>connection.get_result</code>.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-set_single_row_mode"><a href="#method-set_single_row_mode" class="anchor"></a><code><span><span class="keyword">method</span> set_single_row_mode : unit</span></code></div><div class="spec-doc"><p><code>#set_single_row_mode</code> called right after <code>connection.send_query</code> or a sibling function causes the returned rows to be split into individual results.</p></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-get_result"><a href="#method-get_result" class="anchor"></a><code><span><span class="keyword">method</span> get_result : <span><a href="../class-type-result/index.html">result</a> option</span></span></code></div><div class="spec-doc"><p><code>get_result</code></p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p><code>Some result</code> of an asynchronous query if available or <code>None</code>.</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><p>Copy operations</p><p>Low level</p><div class="odoc-spec"><div class="spec method anchored" id="method-put_copy_data"><a href="#method-put_copy_data" class="anchor"></a><code><span><span class="keyword">method</span> put_copy_data : <span><span class="optlabel">?pos</span>:int <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?len</span>:int <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <a href="../index.html#type-put_copy_result">put_copy_result</a></span></code></div><div class="spec-doc"><p><code>put_copy_data ?pos ?len buf</code> sends <code>buf</code> of length <code>len</code> starting at <code>pos</code> to the backend server, which must be in copy-in mode. In non-blocking mode, returns <code>Put_copy_not_queued</code> if the data was not queued due to full buffers.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">pos</span> <p>default = 0</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">len</span> <p>default = String.length - pos</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Invalid_argument</code> <p>if the buffer parameters are invalid.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-put_copy_end"><a href="#method-put_copy_end" class="anchor"></a><code><span><span class="keyword">method</span> put_copy_end : <span><span class="optlabel">?error_msg</span>:string <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <a href="../index.html#type-put_copy_result">put_copy_result</a></span></code></div><div class="spec-doc"><p><code>put_copy_end ?error_msg ()</code> terminates the copy-in mode, leaving the connection in <code>Command_ok</code> or failed state. In non-blocking mode, returns <code>Put_copy_not_queued</code> if the termination message was not queued due to full buffers. Also, to ensure delivery of data in non-blocking mode, repeatedly wait for write-ready an call <code>connection.flush</code>.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">error_msg</span> <p>if set, force the copy operation to fail with the given message.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-get_copy_data"><a href="#method-get_copy_data" class="anchor"></a><code><span><span class="keyword">method</span> get_copy_data : <span><span class="optlabel">?async</span>:bool <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <a href="../index.html#type-get_copy_result">get_copy_result</a></span></code></div><div class="spec-doc"><p><code>get_copy_data ?async ()</code> retrieves the next row of data if available. Only single complete rows are returned. In synchronous mode, the call will wait for completion of the next row. In asynchronous mode it will return immediately with <code>Get_copy_wait</code> if the row transfer is incomplete. In that case, wait for read-ready and call <code>connection.consume_input</code> before retrying.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">async</span> <p>default = false</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-getline"><a href="#method-getline" class="anchor"></a><code><span><span class="keyword">method</span> getline : <span><span class="optlabel">?pos</span>:int <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?len</span>:int <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Stdlib</span>.Bytes.t <span class="arrow">&#45;&gt;</span></span> <a href="../index.html#type-getline_result">getline_result</a></span></code></div><div class="spec-doc"><p><code>getline ?pos ?len buf</code> reads a newline-terminated line of at most <code>len</code> characters into <code>buf</code> starting at position <code>pos</code>.</p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>getline_result</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">pos</span> <p>default = 0</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">len</span> <p>default = Bytes.length buf - pos</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Invalid_argument</code> <p>if the buffer parameters are invalid.</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-getline_async"><a href="#method-getline_async" class="anchor"></a><code><span><span class="keyword">method</span> getline_async : <span><span class="optlabel">?pos</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?len</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Stdlib</span>.Bytes.t <span class="arrow">&#45;&gt;</span></span>
  <a href="../index.html#type-getline_async_result">getline_async_result</a></span></code></div><div class="spec-doc"><p><code>getline_async ?pos ?len buf</code> reads a newline-terminated line of at most <code>len</code> characters into <code>buf</code> starting at position <code>pos</code> (asynchronously). No need to call <code>endcopy</code> after receiving <code>EndOfData</code>.</p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>getline_async_result</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">pos</span> <p>default = 0</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">len</span> <p>default = Bytes.length buf - pos</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Invalid_argument</code> <p>if the buffer parameters are invalid.</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-putline"><a href="#method-putline" class="anchor"></a><code><span><span class="keyword">method</span> putline : <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>putline str</code> sends <code>str</code> to backend server. Don't use this method for binary data, use putnbytes instead!</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-putnbytes"><a href="#method-putnbytes" class="anchor"></a><code><span><span class="keyword">method</span> putnbytes : <span><span class="optlabel">?pos</span>:int <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?len</span>:int <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>putnbytes ?pos ?len buf</code> sends the substring of <code>buf</code> of length <code>len</code> starting at <code>pos</code> to backend server (use this method for binary data).</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">pos</span> <p>default = 0</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">len</span> <p>default = String.length buf - pos</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Invalid_argument</code> <p>if the buffer parameters are invalid.</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-endcopy"><a href="#method-endcopy" class="anchor"></a><code><span><span class="keyword">method</span> endcopy : unit</span></code></div><div class="spec-doc"><p><code>endcopy</code> synchronizes with the backend.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><p>High level</p><div class="odoc-spec"><div class="spec method anchored" id="method-copy_out"><a href="#method-copy_out" class="anchor"></a><code><span><span class="keyword">method</span> copy_out : <span><span>(<span>string <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>copy_out f</code> applies <code>f</code> to each line returned by backend server.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-copy_out_channel"><a href="#method-copy_out_channel" class="anchor"></a><code><span><span class="keyword">method</span> copy_out_channel : <span><span class="xref-unresolved">Stdlib</span>.out_channel <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>copy_out_channel ch</code> sends each line returned by backend server to output channel <code>ch</code>.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-copy_in_channel"><a href="#method-copy_in_channel" class="anchor"></a><code><span><span class="keyword">method</span> copy_in_channel : <span><span class="xref-unresolved">Stdlib</span>.in_channel <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>copy_in_channel ch</code> sends each line in input channel <code>ch</code> to backend server.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><p>Asynchronous operations and non blocking mode</p><div class="odoc-spec"><div class="spec method anchored" id="method-connect_poll"><a href="#method-connect_poll" class="anchor"></a><code><span><span class="keyword">method</span> connect_poll : <a href="../index.html#type-polling_status">polling_status</a></span></code></div><div class="spec-doc"><p>After creating a connection with <code>~startonly:true</code>, <code>connection.connect_poll</code> must be called a number of times before the connection can be used. The precise procedure is described in the libpq manual, but the following code should capture the idea, assuming monadic concurrency primitives <code>return</code> and <code>&gt;&gt;=</code> along with polling functions <code>wait_for_read</code> and <code>wait_for_write</code>:</p><pre class="language-ocaml"><code>let my_async_connect () =
  let c = new connection () in
  let rec establish_connection = function
    | Polling_failed | Polling_ok -&gt; return c
    | Polling_reading -&gt;
        wait_for_read c#socket &gt;&gt;= fun () -&gt;
        establish_connection c#connect_poll
    | Polling_writing -&gt;
        wait_for_write c#socket &gt;&gt;= fun () -&gt;
        establish_connection c#connect_poll
  in
  establish_connection Polling_writing</code></pre><p>See also <code>examples/async.ml</code>.</p></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-reset_start"><a href="#method-reset_start" class="anchor"></a><code><span><span class="keyword">method</span> reset_start : bool</span></code></div><div class="spec-doc"><p>An asynchronous variant of <code>connection.reset</code>. Use <code>connection.reset_poll</code> to finish re-establishing the connection.</p></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-reset_poll"><a href="#method-reset_poll" class="anchor"></a><code><span><span class="keyword">method</span> reset_poll : <a href="../index.html#type-polling_status">polling_status</a></span></code></div><div class="spec-doc"><p>Used analogously to <code>connection.connect_poll</code> after calling <code>connection.reset_start</code>.</p></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-set_nonblocking"><a href="#method-set_nonblocking" class="anchor"></a><code><span><span class="keyword">method</span> set_nonblocking : <span>bool <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>set_nonblocking b</code> sets state of the connection to nonblocking if <code>b</code> is true and to blocking otherwise.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-is_nonblocking"><a href="#method-is_nonblocking" class="anchor"></a><code><span><span class="keyword">method</span> is_nonblocking : bool</span></code></div><div class="spec-doc"><p><code>is_nonblocking</code></p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>the blocking status of the connection.</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-consume_input"><a href="#method-consume_input" class="anchor"></a><code><span><span class="keyword">method</span> consume_input : unit</span></code></div><div class="spec-doc"><p><code>consume_input</code> consume any available input from backend.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-is_busy"><a href="#method-is_busy" class="anchor"></a><code><span><span class="keyword">method</span> is_busy : bool</span></code></div><div class="spec-doc"><p><code>is_busy</code></p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>busy status of a query.</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-flush"><a href="#method-flush" class="anchor"></a><code><span><span class="keyword">method</span> flush : <a href="../index.html#type-flush_status">flush_status</a></span></code></div><div class="spec-doc"><p><code>flush</code> attempts to flush any data queued to the backend.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-socket"><a href="#method-socket" class="anchor"></a><code><span><span class="keyword">method</span> socket : int</span></code></div><div class="spec-doc"><p><code>socket</code> obtains the file descriptor for the backend connection socket as an integer.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-request_cancel"><a href="#method-request_cancel" class="anchor"></a><code><span><span class="keyword">method</span> request_cancel : unit</span></code></div><div class="spec-doc"><p><code>request_cancel</code> requests that PostgreSQL abandon processing of the current command.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection or cancel error.</p></li></ul></div></div><p>Large objects</p><div class="odoc-spec"><div class="spec method anchored" id="method-lo_creat"><a href="#method-lo_creat" class="anchor"></a><code><span><span class="keyword">method</span> lo_creat : <a href="../index.html#type-oid">oid</a></span></code></div><div class="spec-doc"><p><code>lo_creat</code> creates a new large object and returns its oid.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-lo_import"><a href="#method-lo_import" class="anchor"></a><code><span><span class="keyword">method</span> lo_import : <span>string <span class="arrow">&#45;&gt;</span></span> <a href="../index.html#type-oid">oid</a></span></code></div><div class="spec-doc"><p><code>lo_import filename</code> imports an operating system file given by <code>filename</code> as a large object.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-lo_export"><a href="#method-lo_export" class="anchor"></a><code><span><span class="keyword">method</span> lo_export : <span><a href="../index.html#type-oid">oid</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>lo_export oid filename</code> exports the large object given by <code>oid</code> to an operating system file given by <code>filename</code>.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-lo_open"><a href="#method-lo_open" class="anchor"></a><code><span><span class="keyword">method</span> lo_open : <span><a href="../index.html#type-oid">oid</a> <span class="arrow">&#45;&gt;</span></span> <a href="../index.html#type-large_object">large_object</a></span></code></div><div class="spec-doc"><p><code>lo_open oid</code> opens the large object given by <code>oid</code> for reading and writing.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-lo_write"><a href="#method-lo_write" class="anchor"></a><code><span><span class="keyword">method</span> lo_write : <span><span class="optlabel">?pos</span>:int <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?len</span>:int <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="../index.html#type-large_object">large_object</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>lo_write ?pos ?len buf lo</code> writes <code>len</code> bytes of buffer <code>buf</code> starting at position <code>pos</code> to large object <code>lo</code>.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">pos</span> <p>default = 0</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">len</span> <p>default = String.length buf - pos</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Invalid_argument</code> <p>if the buffer parameters are invalid.</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if <code>len</code> bytes could not be written.</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-lo_write_ba"><a href="#method-lo_write_ba" class="anchor"></a><code><span><span class="keyword">method</span> lo_write_ba : <span><span class="optlabel">?pos</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?len</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(char, <span class="xref-unresolved">Stdlib</span>.Bigarray.int8_unsigned_elt, <span class="xref-unresolved">Stdlib</span>.Bigarray.c_layout)</span>
    <span class="xref-unresolved">Stdlib</span>.Bigarray.Array1.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../index.html#type-large_object">large_object</a> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p>As <code>lo_write</code>, but performs a zero-copy write from the given Bigarray.</p></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-lo_read"><a href="#method-lo_read" class="anchor"></a><code><span><span class="keyword">method</span> lo_read : <span><a href="../index.html#type-large_object">large_object</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?pos</span>:int <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?len</span>:int <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Stdlib</span>.Bytes.t <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p><code>lo_read lo ?pos ?len buf</code> reads <code>len</code> bytes from large object <code>lo</code> to buffer <code>buf</code> starting at position <code>pos</code>.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">pos</span> <p>default = 0</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">len</span> <p>default = Bytes.length buf - pos</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Invalid_argument</code> <p>if the buffer parameters are invalid.</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if <code>len</code> bytes could not be read.</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-lo_read_ba"><a href="#method-lo_read_ba" class="anchor"></a><code><span><span class="keyword">method</span> lo_read_ba : <span><a href="../index.html#type-large_object">large_object</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?pos</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?len</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(char, <span class="xref-unresolved">Stdlib</span>.Bigarray.int8_unsigned_elt, <span class="xref-unresolved">Stdlib</span>.Bigarray.c_layout)</span>
    <span class="xref-unresolved">Stdlib</span>.Bigarray.Array1.t</span> <span class="arrow">&#45;&gt;</span></span>
  int</span></code></div><div class="spec-doc"><p>As <code>lo_read</code>, but performs a zero-copy read into the given Bigarray.</p></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-lo_seek"><a href="#method-lo_seek" class="anchor"></a><code><span><span class="keyword">method</span> lo_seek : <span><span class="optlabel">?pos</span>:int <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?whence</span>:<a href="../index.html#type-seek_cmd">seek_cmd</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../index.html#type-large_object">large_object</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>lo_seek ?pos ?whence lo</code> seeks read/write position <code>pos</code> in large object <code>lo</code> relative to the start, current read/write position, or end of the object (<code>whence</code> is SEEK_SET, SEEK_CUR, SEEK_END respectively).</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">pos</span> <p>default = 0</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">whence</span> <p>default = <code>SEEK_SET</code></p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-lo_tell"><a href="#method-lo_tell" class="anchor"></a><code><span><span class="keyword">method</span> lo_tell : <span><a href="../index.html#type-large_object">large_object</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p><code>lo_tell lo</code></p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>current read/write position of large object <code>lo</code>.</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-lo_close"><a href="#method-lo_close" class="anchor"></a><code><span><span class="keyword">method</span> lo_close : <span><a href="../index.html#type-large_object">large_object</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>lo_close lo</code> closes large object <code>lo</code>.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-lo_unlink"><a href="#method-lo_unlink" class="anchor"></a><code><span><span class="keyword">method</span> lo_unlink : <span><a href="../index.html#type-oid">oid</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>lo_unlink oid</code> removes the large object specified by <code>oid</code> from the database.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Error</code> <p>if there is a connection error.</p></li></ul></div></div><p>Escaping</p><div class="odoc-spec"><div class="spec method anchored" id="method-escape_string"><a href="#method-escape_string" class="anchor"></a><code><span><span class="keyword">method</span> escape_string : <span><span class="optlabel">?pos</span>:int <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?len</span>:int <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>escape_string ?pos ?len str</code> escapes ASCII-substring <code>str</code> of length <code>len</code> starting at position <code>pos</code> for use within SQL.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">pos</span> <p>default = 0</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">len</span> <p>default = String.length str - pos</p></li></ul></div></div><div class="odoc-spec"><div class="spec method anchored" id="method-escape_bytea"><a href="#method-escape_bytea" class="anchor"></a><code><span><span class="keyword">method</span> escape_bytea : <span><span class="optlabel">?pos</span>:int <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?len</span>:int <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>escape_bytea ?pos ?len str</code> escapes binary substring <code>str</code> of length <code>len</code> starting at position <code>pos</code> for use within SQL.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">pos</span> <p>default = 0</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">len</span> <p>default = String.length str - pos</p></li></ul></div></div></div></body></html>
